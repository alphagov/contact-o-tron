<%= form.inputs do %>
  <%= form.input :name %>
  <%= form.input :postal_address %>

  <%= form.inputs 'Phone numbers' do %>
    <% form.object.phone_numbers.each do |phone_number| %>
      <%= semantic_fields_for 'contact[phone_numbers_attributes][]', phone_number, :index => nil do |form| %>
        <div class="phone-group">
          <%= render 'phone_numbers/form', :form => form %>
        </div>
      <% end %>
    <% end %>

    <%= semantic_fields_for 'contact[phone_numbers_attributes][]', PhoneNumber.new, :index => nil do |form| %>
      <div class="phone-group blank">
        <%= render 'phone_numbers/form', :form => form %>
      </div>
    <% end %>
  <% end %>

  <%= form.input :email_address %>
  <%= form.input :website_url %>
  <%= form.input :opening_hours %>

  <div class="format-controls">
    <li><%= link_to 'Cancel', form.object.new_record? ? contacts_path : contact_path(form.object), :class => 'button' %></li>
    <li><%= form.submit "#{form.object.new_record? ? 'Create' : 'Update'} Contact", :class => form.object.new_record? ? 'create' : 'update' %></li>
  </div>
<% end %>

<%= javascript_tag do %>
  $(function () {
    var blankPhoneNumber = $('.phone-group.blank');
    var button = $('<a>', {
      text:   'Add new phone number',
      class:  'button'
    });

    blankPhoneNumber.hide();
    button.insertBefore(blankPhoneNumber);
  });
<% end %>
